exports.id=184,exports.ids=[184],exports.modules={7806:(t,e,r)=>{"use strict";r.d(e,{v:()=>o});var i=r(56037);class s{static isEmpty(t){return"number"!=typeof t&&"boolean"!=typeof t&&!(t instanceof Date)&&(!!(null==t||t instanceof Object&&!Object.keys(t).length||Array.isArray(t)&&0===t.length)||""===t)}static isDuplicate(t){return!!t.find((e,r)=>t.indexOf(e)!==r)}static isEmail(t){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(t)}static isInvalidString(t){return/[^0-9A-Za-z_.-]+/.test(t)}static isNotDateString(t){return!/\d{4}-\d{2}-\d{2}/.test(t)}static isNoKasbon(t){return/BON\d{10}/.test(t)}}class a{constructor(t,e){this.validateProps(t),this.props=t,this._id=e||new i.Types.ObjectId}static isEntity(t){return t instanceof a}get propsCopy(){return Object.freeze({_id:this._id,...this.props})}validateProps(t){if(s.isEmpty(t))throw Error("Entity props should not be empty!");if("object"!=typeof t)throw Error("Entity props should be an object")}}var n=r(38748);class o extends a{static{this.hashService=new n.G}constructor(t,e){super(t,e)}static async create(t){let e=await this.hashService.generate(t.password);return new o({first_name:t.first_name,last_name:t.last_name,username:t.username,password:e,role:t.role,email:t.email||"-",create_at:t.create_at,input_by:t.input_by})}async hashPassword(){this.props.password=await o.hashService.generate(this.props.password)}async updateData(t){t.first_name&&(this.props.first_name=t.first_name),t.last_name&&(this.props.last_name=t.last_name),t.email&&(this.props.email=t.email),t.role&&(this.props.role=t.role),t.password&&(this.props.password=await o.hashService.generate(t.password))}}},8748:(t,e,r)=>{"use strict";r.d(e,{A:()=>g});var i=r(56037),s=r(55511),a=r.n(s);let n=process.env.NEXT_ENCKEY||"default-strong-key";class o{constructor(){this.algorithm="aes-256-cbc",this.ivLength=16,this.secretKey=a().createHash("sha256").update(n).digest()}doEncrypt(t,e){if(!t)return t;if(Array.isArray(t))return t.map(t=>"string"==typeof t?this.encrypt(t):"object"==typeof t&&null!==t?this.doEncrypt(t,e):t);if("object"==typeof t&&!(t instanceof Date)){let r={...t};for(let t of Object.keys(r)){if(e?.includes(t))continue;let i=r[t];"string"==typeof i?r[t]=this.encrypt(i):"number"==typeof i?r[t]=i:Array.isArray(i)?r[t]=i.map(t=>"string"==typeof t?this.encrypt(t):"object"==typeof t&&null!==t?this.doEncrypt(t,e):t):"object"==typeof i&&null!==i&&(r[t]=this.doEncrypt(i,e))}return r}return"string"==typeof t?this.encrypt(t):t}doDecrypt(t,e){if(!t)return t;if(Array.isArray(t))return t.map(t=>{if("string"==typeof t)try{return this.decrypt(t)}catch{return t}return"object"==typeof t&&null!==t?this.doDecrypt(t,e):t});if("object"==typeof t&&!(t instanceof Date)){let r={...t};for(let t of Object.keys(r)){if(e?.includes(t))continue;let i=r[t];if("string"==typeof i)try{r[t]=this.decrypt(i)}catch{r[t]=i}else Array.isArray(i)?r[t]=i.map(t=>{if("string"==typeof t)try{return this.decrypt(t)}catch{return t}return"object"==typeof t&&null!==t?this.doDecrypt(t,e):t}):"object"==typeof i&&null!==i&&(r[t]=this.doDecrypt(i,e))}return r}if("string"==typeof t)try{return this.decrypt(t)}catch{}return t}encrypt(t){let e=a().randomBytes(this.ivLength),r=a().createCipheriv(this.algorithm,this.secretKey,e),i=Buffer.concat([r.update(t,"utf8"),r.final()]);return Buffer.concat([e,i]).toString("hex")}decrypt(t){let e=Buffer.from(t,"hex"),r=e.subarray(0,this.ivLength),i=e.subarray(this.ivLength),s=a().createDecipheriv(this.algorithm,this.secretKey,r);return Buffer.concat([s.update(i),s.final()]).toString("utf8")}}let c=new o;class p{constructor(t,e,r){this.genericModel=t,this.genericMapper=e,this.encryptor=c,this.ignore=r}async findAll(){let t=await this.genericModel.find();return this.encryptor.doDecrypt(t,this.ignore).map(t=>this.genericMapper.toDomain(t))}async findBy(t,e){t._id&&this._validateMongoID(t._id);let r=(await this.genericModel.find(t,{},{session:e})).map(t=>t.toObject());return this.encryptor.doDecrypt(r,this.ignore).map(t=>this.genericMapper.toDomain(t))}async findOne(t,e){t._id&&this._validateMongoID(t._id);let r=(await this.genericModel.findOne(t,{},{session:e}))?.toObject(),i=this.encryptor.doDecrypt(r,this.ignore);if(i)return this.genericMapper.toDomain(i)}async findById(t,e=null){t&&this._validateMongoID(t);let r=await this.genericModel.findById(t).session(e),i=this.encryptor.doDecrypt(r,this.ignore);if(i)return this.genericMapper.toDomain(i)}async create(t,e){let r=this.genericMapper.toPlainObject(t),i=this.encryptor.doEncrypt(r,this.ignore),s=new this.genericModel(i);return{_id:(await s.save({session:e}))._id}}async updateMany(t,e,r){t._id&&this._validateMongoID(t._id);let i=this.genericMapper.toPlainObject(e),s=this.encryptor.doEncrypt(i,this.ignore),{matchedCount:a,modifiedCount:n}=await this.genericModel.updateMany(t,{$set:s},{session:r});if(!a)throw Error(`E 404: ${this.constructor.name.replace("Repository","").toUpperCase()} NOT FOUND, UPDATE FAILED`);return{n:a,nModified:n}}async updateOne(t,e,r){t._id&&this._validateMongoID(t._id);let i=this.genericMapper.toPlainObject(e),s=this.encryptor.doEncrypt(i,this.ignore),{matchedCount:a,modifiedCount:n}=await this.genericModel.updateOne(t,{$set:s},{session:r});if(!a)throw Error(`E 404: ${this.constructor.name.replace("Repository","").toUpperCase()} NOT FOUND, UPDATE FAILED`);return{n:a,nModified:n}}async delete(t,e){t._id&&this._validateMongoID(t._id);let{deletedCount:r}=await this.genericModel.deleteMany(t,{session:e});return{n:r}}_validateMongoID(t){if(!(0,i.isValidObjectId)(t))throw Error("E 400: ID NOT VALID")}}let d=new i.Schema({first_name:{type:String,required:!0},last_name:{type:String,required:!0},username:{type:String,required:!0},password:{type:String,required:!0},role:{type:String,required:!0},email:{type:String,default:"-"},create_at:{type:Date,default:new Date},input_by:{type:String,default:"-"}},{timestamps:!0}),l=i.models.tm_user||(0,i.model)("tm_user",d,"tm_user");var y=r(66252);let h=["_id","username","password","create_at","createdAt","updatedAt","role","__v"];class u extends p{constructor(){super(l,y.R,h)}async findActiveUser(){return await this.genericModel.find()}}class f{constructor(){this.userRepository=new u}}let g=new f},38748:(t,e,r)=>{"use strict";r.d(e,{G:()=>s});var i=r(5486);class s{async generate(t){return await i.hash(t,10)}async compare(t,e){return await i.compare(t,e)}}},66252:(t,e,r)=>{"use strict";r.d(e,{R:()=>s}),Object.create;Object.create;var i=("function"==typeof SuppressedError&&SuppressedError,r(7806));class s{static toPlainObject(t){return{...t.propsCopy}}static toDomain(t){return new i.v({_id:t._id,first_name:t.first_name,last_name:t.last_name,username:t.username,password:t.password,email:t.email||"-",role:t.role||"-",create_at:t.create_at||"-",input_by:t.input_by||"-"})}}s=function(t,e,r,i){var s,a=arguments.length,n=a<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,r,i);else for(var o=t.length-1;o>=0;o--)(s=t[o])&&(n=(a<3?s(n):a>3?s(e,r,n):s(e,r))||n);return a>3&&n&&Object.defineProperty(e,r,n),n}([t=>{}],s)},78335:()=>{},96487:()=>{}};